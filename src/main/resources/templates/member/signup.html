<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>SB Admin 2 - SignUp</title>

    <!-- Custom fonts for this template-->
    <link href="/css/all.css" rel="stylesheet" type="text/css">
    <link
            href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
            rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="/css/sb-admin-2.css" rel="stylesheet">

</head>

<body class="bg-gradient-primary">

<div class="container">

    <div class="card o-hidden border-0 shadow-lg my-5">
        <div class="card-body p-0">
            <!-- Nested Row within Card Body -->
            <div class="row">
                <div class="col-lg-5 d-none d-lg-block bg-register-image"
                     style="align-items:center !important; display: flex !important; justify-content:center !important;">
                    <img src="/img/register.png" alt="ì´ë¯¸ì§€ ìë¦¬" width="191" height="187">
                </div>
                <div class="col-lg-7">
                    <div class="p-5">
                        <div class="text-center">
                            <h1 class="h4 text-gray-900 mb-4">Create an Account!</h1>
                        </div>
                        <form action="/member/signup2" method="POST" id="signUpForm" class="user">
                            <div class="form-group row">
                                <!-- 6ì¹¸: ì…ë ¥ í•„ë“œ -->
                                <div class="col-sm-6">
                                    <input type="text" class="form-control form-control-user" id="inputId"
                                           name="userId" placeholder="ID">
                                </div>
                                <!-- 4ì¹¸: ì¤‘ë³µ ì²´í¬ ê²°ê³¼ -->
                                <div class="col-sm-4">
                                    <span id="idCheckResult" style="font-size: 0.85rem; display: block;"></span>
                                </div>
                                <!-- 2ì¹¸: ë²„íŠ¼ -->
                                <div class="col-sm-2">
                                    <button type="button" class="btn btn-primary btn-user btn-block" id="checkIdBtn">
                                        Check
                                    </button>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-sm-6 mb-3 mb-sm-0">
                                    <input type="password" class="form-control form-control-user"
                                           id="inputPassword" name="userPw" placeholder="Password">
                                </div>
                                <div class="col-sm-6">
                                    <input type="password" class="form-control form-control-user"
                                           id="repeatPassword" placeholder="Repeat Password">
                                </div>
                            </div>
                            <div class="form-group">
                                <input type="text" class="form-control form-control-user" id="inputName"
                                       name="userName"
                                       placeholder="Name">
                            </div>
                            <div class="form-group">
                                <input type="email" class="form-control form-control-user" id="inputEmail"
                                       name="userEmail"
                                       placeholder="Email Address">
                            </div>
                            <button type="button" id="submitBtn" class="btn btn-primary btn-user btn-block">
                                Register Account
                            </button>
                        </form>
                        <hr>
                        <div class="text-center">
                            <a class="small" href="/">Already have an account? Login!</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- Bootstrap core JavaScript-->
<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="/js/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="/js/sb-admin-2.min.js"></script>

<!-- axios ë¹„ë™ê¸° í†µì‹ ìš© -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<th:block layout:fragment="script">
    <!--  ìë°” ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€ ì½”ë“œ  -->
    <script>
        // ì „ì—­ë³€ìˆ˜ ì„¤ì •
        let idCheckPass = false; // ì•„ì´ë”” ì¤‘ë³µ ì²´í¬ ì•ˆí•¨.

        // ID ì¤‘ë³µ ì²´í¬ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        document.getElementById("checkIdBtn").addEventListener("click", function () {
            const id = document.getElementById("inputId").value.trim();
            if (!id) {
                alert("ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;  // í•¨ìˆ˜ í˜¸ì¶œì‹œ ë”ì´ìƒ ì§„í–‰í•˜ê³  ì‹¶ì§€ ì•Šì„ ë•Œ: returní•˜ë©´ ì¢…ë£Œ
            }
            // idê°€ 5ê¸€ì ì´ìƒì¸ì§€ ì²´í¬
            if (id.length < 4) {
                alert("ì•„ì´ë””ëŠ” ìµœì†Œ 4ê¸€ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }
            // idë¥¼ ì„œë²„ë¡œ ë³´ë‚´ë©´ì„œ ì¤‘ë³µì²´í¬í•´ë‹¬ë¼ê³  ìš”ì²­í•˜ê³ 
            //   í™”ë©´ì´ ë„˜ì–´ê°€ì§€ ì•Šê³ , ì›í•  ë•Œ(ë²„íŠ¼ í´ë¦­) ìˆœì„œë‘ ìƒê´€ì—†ì´ ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ê¸°ìˆ  í•„ìš”:
            //   ë¹„ë™ê¸°í†µì‹ (ìë°”ìŠ¤í¬ë¦½íŠ¸ ê¸°ìˆ : ajax, ì—ì´ì‘ìŠ¤)
            //   ==> XMLHttpRequest ê°ì²´, fetch(), axios ê°ì²´
            //       ë¸Œë¼ìš°ì €ì— ì—†ìœ¼ë¯€ë¡œ layout.htmlì— cdnìœ¼ë¡œ ì—°ê²°
            //   ajaxì˜ ê²°ê³¼ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë°ì´í„°ë§Œ ë°›ì•„ì˜¨ë‹¤. (int, boolean, string, float, list, map, ...)
            //   axios.get(ìš”ì²­ ì£¼ì†Œ).then(ì‘ë‹µë°›ê³  ë‚˜ì„œ ì²˜ë¦¬í•  ë‚´ìš©);

            // ì„œë²„ë¡œ ì¤‘ë³µ ì²´í¬ ìš”ì²­
            axios
                .get("/member/checkId?userId=" + id)
                .then(function (response) {
                    // axios.get(ì£¼ì†Œ) : http í”„ë¡œí† ì½œì„ ë§Œë“¤ì–´ì„œ http ìš”ì²­ì„ í•¨.
                    // ì‘ë‹µì´ ì˜¤ë©´ thenì´ ì‹¤í–‰ë¨.
                    // ìµëª…í•¨ìˆ˜ì•ˆì— ë³€ìˆ˜ì´ë¦„ í•˜ë‚˜ë¥¼ ë„£ì–´ë‘ë©´ ê±°ê¸°ì— ì‘ë‹µê°ì²´ë¥¼ ë„£ì–´ì¤Œ.
                    // alert(response.data);   // httpì˜ bodyë¥¼ êº¼ë‚´ì¤Œ.  // MemberControllerì˜ checkId ë©”ì„œë“œ return ê°’
                    // alert(response.status); // httpì˜ ì‘ë‹µì½”ë“œë¥¼ êº¼ë‚´ì¤Œ.
                    const result = response.data;  // http body ì¶”ì¶œ
                    const idCheckResult = document.getElementById("idCheckResult");
                    if (result) {
                        // span íƒœê·¸ ì‚¬ì´ì— ë„£ì–´ì•¼í•¨.
                        idCheckPass = true; // ì•„ì´ë”” ì¤‘ë³µ ì²´í¬ ì™„ë£Œ
                        idCheckResult.style.color = "green";
                        idCheckResult.textContent = "ğŸ‰ ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ì´ë””.";
                    } else {
                        idCheckResult.style.color = "red";
                        idCheckResult.textContent = "âš ï¸ ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì•„ì´ë””.";
                    }
                })
                .catch(function (error) {
                    alert("ì•„ì´ë”” ì¤‘ë³µ ì²´í¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                    console.log(error);
                });

            // ì„œë²„ë¡œë¶€í„° ì¤‘ë³µì²´í¬ ê²°ê³¼ë¥¼ ë°›ì€ ì´í›„ì— ì¶œë ¥
            // (ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ì´ë””, ë¶ˆê°€ëŠ¥í•œ ì•„ì´ë””ì¸ì§€ ì¶œë ¥)
        });

        // ID ì…ë ¥ í•„ë“œ ë³€ê²½ ì‹œ idCheckPass ì´ˆê¸°í™”
        document.getElementById("inputId").addEventListener("input", function () {
            idCheckPass = false; // IDê°€ ë³€ê²½ë˜ë©´ ì¤‘ë³µ ì²´í¬ ìƒíƒœ ì´ˆê¸°í™”
            const idCheckResult = document.getElementById("idCheckResult");
            idCheckResult.textContent = ""; // ê²°ê³¼ ë©”ì‹œì§€ë„ ì´ˆê¸°í™”
        });

        // í¼ ì œì¶œ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        document.getElementById("submitBtn").addEventListener("click", function () {
            const inputId = document.getElementById("inputId").value.trim();
            const inputPassword = document.getElementById("inputPassword").value.trim();
            const repeatPassword = document.getElementById("repeatPassword").value.trim();
            const inputName = document.getElementById("inputName").value.trim();
            const inputEmail = document.getElementById("inputEmail").value.trim();
            console.log(inputId + " " + inputPassword + " " + inputName + " " + inputEmail);

            // ìœ íš¨ì„± ê²€ì‚¬
            // ì´ë©”ì¼ ì •ê·œì‹
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            // ì´ë©”ì¼ í˜•ì‹ ê²€ì¦
            if (!emailPattern.test(inputEmail)) {
                alert("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return;
            }
            // id ì¤‘ë³µì²´í¬ ì—¬ë¶€
            if (idCheckPass != true) {
                alert("ì•„ì´ë”” ì¤‘ë³µ ì²´í¬ë¥¼ ì™„ë£Œí•´ì£¼ì„¸ìš”.");
                return;
            }
            // ì „ì²´ ì…ë ¥ì€ ë‹¤ í•œê²ƒì¸ì§€ ì²´í¬
            if (!inputId || !inputPassword || !inputName || !inputEmail) {
                alert("ëª¨ë“  ì…ë ¥ê°’ì„ ì •í™•íˆ ì±„ì›Œì£¼ì„¸ìš”.");
                return;
            }
            // pw == pw2 ì²´í¬
            if (inputPassword !== repeatPassword) {
                alert("ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.");
                return;
            }
            // pwê°€ 4ê¸€ì ì´ìƒì¸ì§€ ì²´í¬
            if (inputPassword.length < 4) {
                alert("ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 4ê¸€ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            // ì´ í•¨ìˆ˜ê°€ returnìœ¼ë¡œ ì¤‘ë‹¨ë˜ì§€ ì•Šì•˜ìœ¼ë©´ í¼ ì „ì†¡í•´ì£¼ì„¸ìš”
            // ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ìœ íš¨ì„± ê²€ì¦ í›„ submit í•˜ë ¤ë©´
            // formë‚´ì˜ buttonì˜ typeì„ type="button"ìœ¼ë¡œ ë°”ê¿”ì¤Œ.
            // í¼ ì œì¶œ
            document.getElementById("signUpForm").submit();
            alert("íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. í™˜ì˜í•©ë‹ˆë‹¤!")
        });

    </script>
</th:block>
</body>

</html>